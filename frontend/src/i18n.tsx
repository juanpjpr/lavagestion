import { createContext, useContext, useState, useCallback, type ReactNode } from 'react';

export type Lang = 'es' | 'en' | 'ko' | 'zh';

const translations: Record<Lang, Record<string, string>> = {
  es: {
    // Login
    login_create_account: 'Crear Cuenta',
    login_sign_in: 'Iniciar Sesión',
    login_tenant_name: 'Nombre de tu Lavadero',
    login_tenant_name_hint: 'Lavandería Don Pedro',
    login_user_name: 'Tu Nombre',
    login_user_name_hint: 'Pedro García',
    login_tenant_slug: 'ID de Tienda',
    login_tenant_slug_hint: 'lavanderia-don-pedro',
    login_email: 'Email',
    login_email_hint: 'admin@milavadero.com',
    login_password: 'Contraseña',
    login_register_btn: 'Crear Cuenta',
    login_enter_btn: 'Entrar',
    login_has_account: '¿Ya tenés cuenta?',
    login_no_account: '¿No tenés cuenta?',
    login_sign_in_link: 'Iniciar Sesión',
    login_register_link: 'Registrarse',
    loading: 'Cargando...',
    login_error: 'Error al iniciar sesión',

    // Orders
    orders_title: 'Pedidos',
    orders_new: '+ Nuevo Pedido',
    orders_empty: 'No hay pedidos',
    orders_search: 'Buscar por nombre, teléfono o ticket...',
    orders_items: 'prenda(s)',
    orders_advance_to: 'Pasar a',
    th_ticket: 'Ticket',
    th_client: 'Cliente',
    th_phone: 'Teléfono',
    th_items: 'Prendas',
    th_total: 'Total',
    th_status: 'Estado',
    th_action: 'Acción',

    // Filters
    filter_all: 'Todos',
    status_received: 'Recibido',
    status_washing: 'Lavando',
    status_ready: 'Listo',
    status_delivered: 'Entregado',

    // New order
    new_order_title: 'Nuevo Pedido',
    new_order_client_section: 'Datos del Cliente',
    new_order_name: 'Nombre',
    new_order_name_hint: 'María García',
    new_order_phone: 'Teléfono',
    new_order_phone_hint: '1155551234',
    new_order_items_section: 'Prendas',
    new_order_add: '+ Agregar prenda',
    new_order_description: 'Descripción',
    new_order_description_hint: 'Camisa blanca',
    new_order_qty: 'Cant.',
    new_order_price: 'Precio',
    new_order_notes: 'Notas (opcional)',
    new_order_notes_hint: 'Mancha en el cuello, tratar con cuidado...',
    new_order_submit: 'Crear Pedido',
    new_order_creating: 'Creando...',
    new_order_cancel: 'Cancelar',
    new_order_total: 'Total',
    new_order_error: 'Agregá al menos una prenda con precio',

    // Reports
    reports_title: 'Reporte Diario',
    reports_orders: 'Pedidos del día',
    reports_income: 'Ingresos del día',
    reports_average: 'Ticket promedio',
    reports_by_status: 'Pedidos por Estado',
    reports_no_data: 'No hay datos',

    // Notify
    notify_title: 'Avisar al cliente',
    notify_message_pre: '¿Querés avisarle a',
    notify_message_post: 'por WhatsApp que su pedido está listo?',
    notify_yes: 'Sí, avisar',
    notify_no: 'No',
    notify_btn: 'WhatsApp',
    notify_whatsapp_pre: '¡Hola! Tu pedido #',
    notify_whatsapp_post: ' está listo para retirar. ¡Te esperamos!',

    // Settings
    settings_title: 'Ajustes',
    settings_language: 'Idioma',
    settings_account: 'Cuenta',
    settings_business: 'Negocio',
    settings_logout: 'Cerrar sesión',
    settings_name: 'Nombre',
    settings_email: 'Email',
    settings_role: 'Rol',
    settings_laundry: 'Lavadero',
    settings_store_id: 'ID de Tienda',
    role_owner: 'Dueño',
    role_employee: 'Empleado',

    // Nav
    nav_orders: 'Pedidos',
    nav_new: 'Nuevo',
    nav_reports: 'Reportes',
    nav_settings: 'Ajustes',
  },

  en: {
    login_create_account: 'Create Account',
    login_sign_in: 'Sign In',
    login_tenant_name: 'Your Laundry Name',
    login_tenant_name_hint: 'Don Pedro Laundry',
    login_user_name: 'Your Name',
    login_user_name_hint: 'Pedro García',
    login_tenant_slug: 'Store ID',
    login_tenant_slug_hint: 'don-pedro-laundry',
    login_email: 'Email',
    login_email_hint: 'admin@mylaundry.com',
    login_password: 'Password',
    login_register_btn: 'Create Account',
    login_enter_btn: 'Sign In',
    login_has_account: 'Already have an account?',
    login_no_account: "Don't have an account?",
    login_sign_in_link: 'Sign In',
    login_register_link: 'Register',
    loading: 'Loading...',
    login_error: 'Login error',

    orders_title: 'Orders',
    orders_new: '+ New Order',
    orders_empty: 'No orders',
    orders_search: 'Search by name, phone or ticket...',
    orders_items: 'item(s)',
    orders_advance_to: 'Move to',
    th_ticket: 'Ticket',
    th_client: 'Client',
    th_phone: 'Phone',
    th_items: 'Items',
    th_total: 'Total',
    th_status: 'Status',
    th_action: 'Action',

    filter_all: 'All',
    status_received: 'Received',
    status_washing: 'Washing',
    status_ready: 'Ready',
    status_delivered: 'Delivered',

    new_order_title: 'New Order',
    new_order_client_section: 'Customer Info',
    new_order_name: 'Name',
    new_order_name_hint: 'María García',
    new_order_phone: 'Phone',
    new_order_phone_hint: '1155551234',
    new_order_items_section: 'Garments',
    new_order_add: '+ Add item',
    new_order_description: 'Description',
    new_order_description_hint: 'White shirt',
    new_order_qty: 'Qty',
    new_order_price: 'Price',
    new_order_notes: 'Notes (optional)',
    new_order_notes_hint: 'Stain on the collar...',
    new_order_submit: 'Create Order',
    new_order_creating: 'Creating...',
    new_order_cancel: 'Cancel',
    new_order_total: 'Total',
    new_order_error: 'Add at least one item with a price',

    reports_title: 'Daily Report',
    reports_orders: 'Orders today',
    reports_income: 'Income today',
    reports_average: 'Average ticket',
    reports_by_status: 'Orders by Status',
    reports_no_data: 'No data',

    notify_title: 'Notify customer',
    notify_message_pre: 'Do you want to notify',
    notify_message_post: 'via WhatsApp that their order is ready?',
    notify_yes: 'Yes, notify',
    notify_no: 'No',
    notify_btn: 'WhatsApp',
    notify_whatsapp_pre: 'Hi! Your order #',
    notify_whatsapp_post: ' is ready for pickup. We\'re waiting for you!',

    settings_title: 'Settings',
    settings_language: 'Language',
    settings_account: 'Account',
    settings_business: 'Business',
    settings_logout: 'Sign out',
    settings_name: 'Name',
    settings_email: 'Email',
    settings_role: 'Role',
    settings_laundry: 'Laundry',
    settings_store_id: 'Store ID',
    role_owner: 'Owner',
    role_employee: 'Employee',

    nav_orders: 'Orders',
    nav_new: 'New',
    nav_reports: 'Reports',
    nav_settings: 'Settings',
  },

  ko: {
    login_create_account: '계정 만들기',
    login_sign_in: '로그인',
    login_tenant_name: '세탁소 이름',
    login_tenant_name_hint: '돈페드로 세탁소',
    login_user_name: '이름',
    login_user_name_hint: 'Pedro García',
    login_tenant_slug: '매장 ID',
    login_tenant_slug_hint: 'don-pedro-laundry',
    login_email: '이메일',
    login_email_hint: 'admin@mylaundry.com',
    login_password: '비밀번호',
    login_register_btn: '계정 만들기',
    login_enter_btn: '로그인',
    login_has_account: '이미 계정이 있으신가요?',
    login_no_account: '계정이 없으신가요?',
    login_sign_in_link: '로그인',
    login_register_link: '회원가입',
    loading: '로딩...',
    login_error: '로그인 오류',

    orders_title: '주문',
    orders_new: '+ 새 주문',
    orders_empty: '주문이 없습니다',
    orders_search: '이름, 전화번호 또는 티켓으로 검색...',
    orders_items: '벌',
    orders_advance_to: '변경',
    th_ticket: '티켓',
    th_client: '고객',
    th_phone: '전화',
    th_items: '세탁물',
    th_total: '합계',
    th_status: '상태',
    th_action: '작업',

    filter_all: '전체',
    status_received: '접수',
    status_washing: '세탁중',
    status_ready: '완료',
    status_delivered: '수령',

    new_order_title: '새 주문',
    new_order_client_section: '고객 정보',
    new_order_name: '이름',
    new_order_name_hint: 'María García',
    new_order_phone: '전화번호',
    new_order_phone_hint: '1155551234',
    new_order_items_section: '세탁물',
    new_order_add: '+ 추가',
    new_order_description: '설명',
    new_order_description_hint: '흰색 셔츠',
    new_order_qty: '수량',
    new_order_price: '가격',
    new_order_notes: '메모 (선택)',
    new_order_notes_hint: '목 부분 얼룩…',
    new_order_submit: '주문 생성',
    new_order_creating: '생성 중...',
    new_order_cancel: '취소',
    new_order_total: '합계',
    new_order_error: '가격이 있는 세탁물을 하나 이상 추가하세요',

    reports_title: '일일 리포트',
    reports_orders: '주문',
    reports_income: '수입',
    reports_average: '평균',
    reports_by_status: '상태별 주문',
    reports_no_data: '데이터 없음',

    notify_title: '고객에게 알리기',
    notify_message_pre: '',
    notify_message_post: '님에게 WhatsApp으로 주문이 완료되었다고 알리시겠습니까?',
    notify_yes: '네, 알리기',
    notify_no: '아니오',
    notify_btn: 'WhatsApp',
    notify_whatsapp_pre: '안녕하세요! 주문 #',
    notify_whatsapp_post: '이(가) 수령 준비되었습니다. 기다리고 있겠습니다!',

    settings_title: '설정',
    settings_language: '언어',
    settings_account: '계정',
    settings_business: '비즈니스',
    settings_logout: '로그아웃',
    settings_name: '이름',
    settings_email: '이메일',
    settings_role: '역할',
    settings_laundry: '세탁소',
    settings_store_id: '매장 ID',
    role_owner: '소유자',
    role_employee: '직원',

    nav_orders: '주문',
    nav_new: '새 주문',
    nav_reports: '리포트',
    nav_settings: '설정',
  },

  zh: {
    login_create_account: '创建账户',
    login_sign_in: '登录',
    login_tenant_name: '洗衣店名称',
    login_tenant_name_hint: '唐佩德罗洗衣店',
    login_user_name: '您的姓名',
    login_user_name_hint: 'Pedro García',
    login_tenant_slug: '店铺 ID',
    login_tenant_slug_hint: 'don-pedro-laundry',
    login_email: '邮箱',
    login_email_hint: 'admin@mylaundry.com',
    login_password: '密码',
    login_register_btn: '创建账户',
    login_enter_btn: '登录',
    login_has_account: '已有账户？',
    login_no_account: '没有账户？',
    login_sign_in_link: '登录',
    login_register_link: '注册',
    loading: '加载中...',
    login_error: '登录错误',

    orders_title: '订单',
    orders_new: '+ 新订单',
    orders_empty: '没有订单',
    orders_search: '按姓名、电话或票号搜索...',
    orders_items: '件',
    orders_advance_to: '移至',
    th_ticket: '票号',
    th_client: '客户',
    th_phone: '电话',
    th_items: '衣物',
    th_total: '合计',
    th_status: '状态',
    th_action: '操作',

    filter_all: '全部',
    status_received: '已接收',
    status_washing: '洗涤中',
    status_ready: '已完成',
    status_delivered: '已取件',

    new_order_title: '新订单',
    new_order_client_section: '客户信息',
    new_order_name: '姓名',
    new_order_name_hint: 'María García',
    new_order_phone: '电话',
    new_order_phone_hint: '1155551234',
    new_order_items_section: '衣物',
    new_order_add: '+ 添加',
    new_order_description: '描述',
    new_order_description_hint: '白色衬衫',
    new_order_qty: '数量',
    new_order_price: '价格',
    new_order_notes: '备注（选填）',
    new_order_notes_hint: '领口有污渍…',
    new_order_submit: '创建订单',
    new_order_creating: '创建中...',
    new_order_cancel: '取消',
    new_order_total: '合计',
    new_order_error: '请至少添加一件有价格的衣物',

    reports_title: '每日报告',
    reports_orders: '订单',
    reports_income: '收入',
    reports_average: '平均',
    reports_by_status: '按状态统计',
    reports_no_data: '无数据',

    notify_title: '通知客户',
    notify_message_pre: '是否通过WhatsApp通知',
    notify_message_post: '订单已完成？',
    notify_yes: '是，通知',
    notify_no: '否',
    notify_btn: 'WhatsApp',
    notify_whatsapp_pre: '您好！您的订单 #',
    notify_whatsapp_post: ' 已准备好取件。我们等您来取！',

    settings_title: '设置',
    settings_language: '语言',
    settings_account: '账户',
    settings_business: '商家',
    settings_logout: '退出登录',
    settings_name: '姓名',
    settings_email: '邮箱',
    settings_role: '角色',
    settings_laundry: '洗衣店',
    settings_store_id: '店铺 ID',
    role_owner: '所有者',
    role_employee: '员工',

    nav_orders: '订单',
    nav_new: '新建',
    nav_reports: '报告',
    nav_settings: '设置',
  },
};

interface I18nContextType {
  lang: Lang;
  setLang: (lang: Lang) => void;
  t: (key: string) => string;
}

const I18nContext = createContext<I18nContextType>({
  lang: 'es',
  setLang: () => {},
  t: (key) => key,
});

export function I18nProvider({ children }: { children: ReactNode }) {
  const [lang, setLangState] = useState<Lang>(() => {
    return (localStorage.getItem('lang') as Lang) || 'es';
  });

  const setLang = useCallback((newLang: Lang) => {
    setLangState(newLang);
    localStorage.setItem('lang', newLang);
  }, []);

  const t = useCallback((key: string) => {
    return translations[lang][key] || translations.es[key] || key;
  }, [lang]);

  return (
    <I18nContext.Provider value={{ lang, setLang, t }}>
      {children}
    </I18nContext.Provider>
  );
}

export function useI18n() {
  return useContext(I18nContext);
}

export const LANG_OPTIONS: { code: Lang; label: string; name: string }[] = [
  { code: 'es', label: 'ES', name: 'Español' },
  { code: 'en', label: 'EN', name: 'English' },
  { code: 'ko', label: '한', name: '한국어' },
  { code: 'zh', label: '中', name: '中文' },
];
